<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kỷ niệm của chúng mình</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --primary-color: #ff6b81;
      --secondary-color: #f8bbd0;
      --text-color: #333;
      --light-color: #fff;
      --shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #fce4ec;
      overflow: hidden;
      height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    .container {
      position: relative;
      width: 100%;
      height: 100%;
      overflow: hidden;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
    }

    .slide {
      position: absolute;
      width: 100%;
      height: 100%;
      top: 0;
      left: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 20px;
      opacity: 0;
      transform: scale(0.9);
      transition: all 0.5s ease-in-out;
    }

    .slide.active {
      opacity: 1;
      transform: scale(1);
      z-index: 10;
    }

    .intro-slide {
      text-align: center;
      background-color: transparent;
      color: var(--text-color);
      padding: 2rem;
      border-radius: 10px;
      max-width: 90%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100%;
    }

    .intro-slide h1 {
      font-size: 3rem;
      margin-bottom: 1.5rem;
      color: var(--primary-color);
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      animation: fadeInDown 1s ease-out;
    }

    .intro-slide p {
      font-size: 1.5rem;
      margin-bottom: 2rem;
      line-height: 1.6;
      animation: fadeIn 1.5s ease-out;
      max-width: 80%;
    }

    .date {
      background-color: var(--primary-color);
      color: var(--light-color);
      padding: 5px 15px;
      border-radius: 20px;
      font-size: 1rem;
      margin-bottom: 15px;
      box-shadow: var(--shadow);
      display: inline-block;
      animation: bounceIn 0.8s;
    }

    .image-container {
      width: 100%;
      max-width: 500px;
      margin: 15px 0;
      position: relative;
      overflow: hidden;
      border-radius: 10px;
      box-shadow: var(--shadow);
      display: flex;
      justify-content: center;
      align-items: center;
      animation: fadeIn 1s ease-out;
    }

    .image-container img {
      max-width: 100%;
      max-height: 60vh;
      object-fit: contain;
      display: block;
    }

    .content {
      background-color: rgba(255, 255, 255, 0.9);
      padding: 15px 20px;
      border-radius: 8px;
      margin-top: 15px;
      box-shadow: var(--shadow);
      max-width: 90%;
      text-align: center;
      animation: fadeInUp 0.8s ease-out;
    }

    .content p {
      font-size: 1.1rem;
      line-height: 1.4;
      color: var(--text-color);
    }

    .btn-next {
      background-color: var(--primary-color);
      color: var(--light-color);
      border: none;
      padding: 12px 24px;
      border-radius: 50px;
      font-size: 1.1rem;
      margin-top: 20px;
      cursor: pointer;
      transition: all 0.3s;
      box-shadow: var(--shadow);
      display: flex;
      align-items: center;
      gap: 8px;
      position: fixed;
      bottom: 60px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 50;
      animation: pulse 2s infinite;
    }

    .btn-next:hover {
      background-color: #ff4d67;
      transform: translateX(-50%) translateY(-2px);
      box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
    }

    .btn-next i {
      font-size: 0.9rem;
      animation: bounceLeft 1.5s infinite;
    }

    @keyframes bounceLeft {
      0%, 100% {
        transform: translateX(0);
      }
      50% {
        transform: translateX(5px);
      }
    }

    @keyframes pulse {
      0% {
        box-shadow: 0 0 0 0 rgba(255, 107, 129, 0.7);
      }
      70% {
        box-shadow: 0 0 0 10px rgba(255, 107, 129, 0);
      }
      100% {
        box-shadow: 0 0 0 0 rgba(255, 107, 129, 0);
      }
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    @keyframes fadeInDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    @keyframes bounceIn {
      0% {
        opacity: 0;
        transform: scale(0.3);
      }
      50% {
        opacity: 1;
        transform: scale(1.05);
      }
      70% {
        transform: scale(0.9);
      }
      100% {
        transform: scale(1);
      }
    }

    .icon-animation {
      position: absolute;
      font-size: 3rem;
      color: var(--primary-color);
      z-index: 20;
    }

    .music-controls {
      position: fixed;
      bottom: 20px;
      left: 20px;
      z-index: 100;
    }

    .btn-music {
      background-color: var(--primary-color);
      color: var(--light-color);
      border: none;
      width: 50px;
      height: 50px;
      border-radius: 50%;
      font-size: 1.2rem;
      cursor: pointer;
      box-shadow: var(--shadow);
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
      opacity: 0;
      pointer-events: none;
      animation: fadeIn 1s forwards;
    }

    .btn-music.visible {
      opacity: 1;
      pointer-events: auto;
    }

    .btn-music:hover {
      background-color: #ff4d67;
      transform: scale(1.1);
    }

    /* Floating icons animation */
    .floating-icons {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 5;
    }

    .floating-icon {
      position: absolute;
      font-size: 1.5rem;
      color: var(--primary-color);
      opacity: 0;
      animation: floatAcross 8s linear infinite;
    }

    @keyframes floatAcross {
      0% {
        transform: translate(-100px, 0);
        opacity: 0;
      }
      10% {
        opacity: 0.7;
      }
      90% {
        opacity: 0.7;
      }
      100% {
        transform: translate(calc(100vw + 100px), 0);
        opacity: 0;
      }
    }

    /* Intro page background animation */
    .intro-background {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      overflow: hidden;
    }

    .heart-bg {
      position: absolute;
      color: rgba(255, 107, 129, 0.2);
      font-size: 3rem;
      animation: floatHeart 15s linear infinite;
    }

    @keyframes floatHeart {
      0% {
        transform: translate(0, 0) rotate(0deg);
        opacity: 0;
      }
      10% {
        opacity: 0.3;
      }
      90% {
        opacity: 0.3;
      }
      100% {
        transform: translate(var(--move-x), var(--move-y)) rotate(var(--rotate));
        opacity: 0;
      }
    }

    /* Animation Positions */
    .icon-heart {
      top: 10%;
      right: 10%;
      animation: heartBeat 1.5s infinite;
    }

    .icon-laugh {
      bottom: 15%;
      right: 10%;
      animation: bounce 2s infinite;
    }

    .icon-car {
      bottom: 10%;
      left: 10%;
      animation: slideInRight 2s infinite;
    }

    .icon-clock {
      top: 15%;
      left: 10%;
      animation: rotateIn 2s infinite;
    }

    .icon-camera {
      top: 10%;
      left: 50%;
      transform: translateX(-50%);
      animation: zoomIn 1.5s infinite;
    }

    .icon-smile {
      bottom: 10%;
      right: 15%;
      animation: tada 2s infinite;
    }

    .icon-food {
      bottom: 15%;
      left: 15%;
      animation: wobble 2.5s infinite;
    }

    .icon-locket {
      top: 15%;
      right: 15%;
      animation: flip 2s infinite;
    }

    .icon-18plus {
      bottom: 10%;
      right: 10%;
      color: #ff4d67;
      animation: pulse 1.5s infinite;
    }

    .icon-hospital {
      top: 15%;
      left: 15%;
      color: #4cb5f5;
      animation: fadeIn 2s infinite;
    }

    .icon-cry {
      bottom: 15%;
      right: 15%;
      color: #4cb5f5;
      animation: shake 2s infinite;
    }

    .icon-funny {
      top: 10%;
      right: 10%;
      color: #ffc107;
      animation: swing 2s infinite;
    }

    .icon-sleep {
      bottom: 15%;
      left: 10%;
      color: #8e44ad;
      animation: fadeInDown 1.5s infinite;
    }

    .icon-gift {
      top: 15%;
      right: 15%;
      color: #e74c3c;
      animation: bounceIn 1.5s infinite;
    }

    .icon-police {
      top: 10%;
      left: 10%;
      color: #3498db;
      animation: flash 2s infinite;
    }

    .icon-sunset {
      bottom: 15%;
      right: 15%;
      color: #f39c12;
      animation: pulse 2s infinite;
    }

    .icon-birthday {
      top: 10%;
      left: 10%;
      color: #e74c3c;
      animation: rubberBand 1.5s infinite;
    }

    .icon-love {
      bottom: 15%;
      right: 10%;
      color: #e74c3c;
      animation: heartBeat 1.5s infinite;
    }

    .icon-rainbow {
      top: 15%;
      left: 50%;
      transform: translateX(-50%);
      animation: fadeInRainbow 2s infinite;
    }

    @keyframes fadeInRainbow {
      0%, 100% {
        opacity: 0.7;
        transform: translateX(-50%) scale(0.9);
      }
      50% {
        opacity: 1;
        transform: translateX(-50%) scale(1.1);
      }
    }

    /* Progress bar */
    .progress-container {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      width: 60%;
      height: 6px;
      background-color: rgba(255, 255, 255, 0.5);
      border-radius: 3px;
      z-index: 100;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .progress-bar {
      height: 100%;
      background-color: var(--primary-color);
      border-radius: 3px;
      transition: width 0.3s ease-in-out;
    }

    /* Ending slide styles */
    .ending-slide {
      text-align: center;
      background-color: transparent;
      color: var(--text-color);
      padding: 2rem;
      max-width: 90%;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      height: 100%;
      position: relative;
      overflow: hidden;
    }

    .ending-background {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      overflow: hidden;
    }

    .ending-icon {
      position: absolute;
      color: rgba(255, 107, 129, 0.3);
      font-size: 2rem;
      animation: floatAndPulse 8s ease-in-out infinite;
    }

    .infinity-icon {
      color: rgba(77, 182, 172, 0.3);
      font-size: 1.8rem;
      animation: floatAndRotate 10s ease-in-out infinite;
    }

    .ending-title {
      font-size: 3rem;
      margin-bottom: 1rem;
      color: var(--primary-color);
      text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
      animation: pulseText 2s infinite;
      z-index: 2;
    }

    .ending-content {
      font-size: 1.5rem;
      line-height: 1.6;
      max-width: 80%;
      background-color: rgba(255, 255, 255, 0.8);
      padding: 1.5rem;
      border-radius: 10px;
      box-shadow: var(--shadow);
      margin-top: 2rem;
      animation: fadeInUp 1s;
      z-index: 2;
    }

    .center-heart {
      font-size: 5rem;
      color: var(--primary-color);
      margin: 1.5rem 0;
      animation: heartbeat 1.5s infinite;
      z-index: 2;
    }

    .btn-restart {
      background-color: #ff4d67;
      margin-top: 2rem;
    }

    @keyframes heartbeat {
      0% {
        transform: scale(1);
      }
      14% {
        transform: scale(1.3);
      }
      28% {
        transform: scale(1);
      }
      42% {
        transform: scale(1.3);
      }
      70% {
        transform: scale(1);
      }
    }

    @keyframes pulseText {
      0% {
        text-shadow: 0 0 5px rgba(255, 107, 129, 0.5);
      }
      50% {
        text-shadow: 0 0 20px rgba(255, 107, 129, 0.8);
      }
      100% {
        text-shadow: 0 0 5px rgba(255, 107, 129, 0.5);
      }
    }

    @keyframes floatAndPulse {
      0% {
        transform: translate(0, 0) scale(1);
        opacity: 0.3;
      }
      50% {
        transform: translate(var(--float-x, 20px), var(--float-y, 20px)) scale(1.2);
        opacity: 0.7;
      }
      100% {
        transform: translate(0, 0) scale(1);
        opacity: 0.3;
      }
    }

    @keyframes floatAndRotate {
      0% {
        transform: translate(0, 0) rotate(0deg);
        opacity: 0.3;
      }
      50% {
        transform: translate(var(--float-x, 30px), var(--float-y, 30px)) rotate(180deg);
        opacity: 0.7;
      }
      100% {
        transform: translate(0, 0) rotate(360deg);
        opacity: 0.3;
      }
    }

    /* Responsive Styles */
    @media (max-width: 768px) {
      .intro-slide h1, .ending-title {
        font-size: 2.2rem;
      }

      .intro-slide p, .ending-content {
        font-size: 1.2rem;
        max-width: 95%;
      }

      .date {
        font-size: 0.9rem;
      }

      .content p {
        font-size: 1rem;
      }

      .btn-next {
        font-size: 1rem;
        padding: 10px 20px;
        bottom: 50px;
      }

      .icon-animation {
        font-size: 2.5rem;
      }
      
      .progress-container {
        width: 80%;
        bottom: 15px;
      }
      
      .center-heart {
        font-size: 4rem;
        margin: 1rem 0;
      }
      
      .ending-icon {
        font-size: 1.5rem;
      }
    }

    @media (max-width: 480px) {
      .intro-slide h1, .ending-title {
        font-size: 1.8rem;
      }

      .intro-slide p, .ending-content {
        font-size: 1rem;
        margin-bottom: 1.5rem;
      }
      
      .ending-content {
        padding: 1rem;
      }

      .image-container {
        max-width: 90%;
      }
      
      .content {
        padding: 10px 15px;
      }
      
      .btn-next {
        padding: 8px 16px;
        font-size: 0.9rem;
        bottom: 45px;
      }
      
      .btn-music {
        width: 40px;
        height: 40px;
        font-size: 1rem;
      }
      
      .center-heart {
        font-size: 3rem;
        margin: 0.8rem 0;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Slides will be generated dynamically by JavaScript -->
  </div>

  <div class="progress-container">
    <div class="progress-bar" id="progressBar"></div>
  </div>

  <div class="music-controls">
    <button class="btn-music" id="btnMusic">
      <i class="fas fa-play"></i>
    </button>
  </div>

  <audio id="bgMusic" loop autoplay preload="auto">
    <source src="bacground-music.mp3" type="audio/mp3">
  </audio>

  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Data from note.json
      const slidesData = [
        {
          "trang": 1,
          "ten_hinh": "",
          "noi_dung": "Cùng nhìn lại những khoảnh khắc bé Dâu với anh Thơm sau 1 năm quen nhau nè",
          "hieu_ung": ""
        },
        {
          "trang": 2,
          "ten_hinh": "h1",
          "noi_dung": "(13/06/2024) Ngày đầu tiên nhắn với em nè, nhắn xong anh xoá fb hẹn hò lun",
          "hieu_ung": "Tim"
        },
        {
          "trang": 3,
          "ten_hinh": "h2",
          "noi_dung": "Lần đầu mình học cùng nhau đó bé",
          "hieu_ung": "Mặc cỡ"
        },
        {
          "trang": 4,
          "ten_hinh": "h3",
          "noi_dung": "(15/06/2024) Ảnh lần đầu qua đón bé về làng nè",
          "hieu_ung": "Xe vivu"
        },
        {
          "trang": 5,
          "ten_hinh": "h4",
          "noi_dung": "Trên đường đón bé",
          "hieu_ung": "Đồng hồ"
        },
        {
          "trang": 6,
          "ten_hinh": "h5",
          "noi_dung": "(16/06/2024) Lần đầu đi học chụp ảnh bé xem",
          "hieu_ung": "máy ảnh"
        },
        {
          "trang": 7,
          "ten_hinh": "h6",
          "noi_dung": "(18/06/2024) Qua đón bé đi ăn mì Osaka nè, bá ngại quá",
          "hieu_ung": "Mặt cười"
        },
        {
          "trang": 8,
          "ten_hinh": "h7",
          "noi_dung": "Bé dâu kể sở thích ăn uống cho anh thơm nghe nè",
          "hieu_ung": "Ăn uống"
        },
        {
          "trang": 9,
          "ten_hinh": "h8",
          "noi_dung": "(23/6/2024) Bả rủ tui tải Locket",
          "hieu_ung": "Locket"
        },
        {
          "trang": 10,
          "ten_hinh": "h9",
          "noi_dung": "(13/07/2024) Bả qua trọ tui nè",
          "hieu_ung": "18+"
        },
        {
          "trang": 11,
          "ten_hinh": "h10",
          "noi_dung": "(21/08/2021) Bé dâu nhập viện, anh qua chăm dâu tây nè",
          "hieu_ung": "Bệnh viện"
        },
        {
          "trang": 12,
          "ten_hinh": "h11",
          "noi_dung": "Khi cô ấy khóc huhuu",
          "hieu_ung": "khóc"
        },
        {
          "trang": 13,
          "ten_hinh": "h12",
          "noi_dung": "Meme của bé dâu thì siêu nhiều",
          "hieu_ung": "hài hước"
        },
        {
          "trang": 14,
          "ten_hinh": "h13",
          "noi_dung": "Bé ngủ phe phẩy ô hô",
          "hieu_ung": "ngủ"
        },
        {
          "trang": 15,
          "ten_hinh": "h14",
          "noi_dung": "(10/12/2024) Cô ấy được anh Thơm tặng babythree nè",
          "hieu_ung": "quà tặng"
        },
        {
          "trang": 16,
          "ten_hinh": "h15",
          "noi_dung": "Dâu chụp khi vừa khóc xong nè",
          "hieu_ung": "khóc"
        },
        {
          "trang": 17,
          "ten_hinh": "h16",
          "noi_dung": "Dâu ngoan ngoãn (hiếm có) chưa",
          "hieu_ung": "cười"
        },
        {
          "trang": 18,
          "ten_hinh": "h17",
          "noi_dung": "Dâu vi phạm nhaaaaa",
          "hieu_ung": "cảnh sát"
        },
        {
          "trang": 20,
          "ten_hinh": "h19",
          "noi_dung": "Dâu với anh ngắm hoàng hôn nè",
          "hieu_ung": "Hoàng hôn"
        },
        {
          "trang": 21,
          "ten_hinh": "h20",
          "noi_dung": "(11/04/2024) Sinh nhật bé ngoan của anh",
          "hieu_ung": "Sinh nhật"
        },
        {
          "trang": 22,
          "ten_hinh": "h21",
          "noi_dung": "Tụi mình mặc áo cặp nè",
          "hieu_ung": "Tình yêu"
        },
        {
          "trang": 23,
          "ten_hinh": "h22",
          "noi_dung": "(18/04/2024) Anh đi CNEP dâu quậy nè",
          "hieu_ung": "Khóc"
        },
        {
          "trang": 24,
          "ten_hinh": "h23",
          "noi_dung": "(03/05/2024) Sinh nhật anh Thơm được Dâu tặng quà hehehe",
          "hieu_ung": "quà tặng"
        },
        {
          "trang": 25,
          "ten_hinh": "h24",
          "noi_dung": "Chúng mình cùng ngắm cầu vồng nè",
          "hieu_ung": "cầu vồng"
        },
        {
          "trang": 26,
          "ten_hinh": "h25",
          "noi_dung": "Hy vọng chúng ta sẽ mãi hạnh phúc như vậy nhaaaaa",
          "hieu_ung": "Trái tim rực rỡ"
        },
        {
          "trang": 27,
          "ten_hinh": "",
          "noi_dung": "1 năm tình yêu tuyệt vời cùng nhau, và mong sẽ còn nhiều năm hạnh phúc tiếp theo. Anh yêu em nhiều lắm, bé Dâu của anh ❤️",
          "hieu_ung": "Tình yêu vĩnh cửu"
        }
      ];

      const container = document.querySelector('.container');
      const bgMusic = document.getElementById('bgMusic');
      const btnMusic = document.getElementById('btnMusic');
      const progressBar = document.getElementById('progressBar');
      let currentIndex = 0;
      let totalSlides = slidesData.length;

      // Đảm bảo nhạc phát được
      function setupAudio() {
        // Hiện nút điều khiển nhạc
        btnMusic.classList.add('visible');
        
        // Thêm sự kiện click để phát nhạc
        document.addEventListener('click', function audioSetup() {
          bgMusic.play().then(() => {
            btnMusic.innerHTML = '<i class="fas fa-pause"></i>';
          }).catch(err => {
            console.log('Không thể tự động phát nhạc:', err);
          });
          
          // Chỉ thực hiện một lần
          document.removeEventListener('click', audioSetup);
        }, { once: true });
        
        // Xử lý khi người dùng tương tác với trang
        document.addEventListener('keydown', function audioSetupKey() {
          bgMusic.play().then(() => {
            btnMusic.innerHTML = '<i class="fas fa-pause"></i>';
          }).catch(err => {
            console.log('Không thể tự động phát nhạc:', err);
          });
          
          // Chỉ thực hiện một lần
          document.removeEventListener('keydown', audioSetupKey);
        }, { once: true });
      }

      // Map animation types to Font Awesome icons and classes
      const animationMap = {
        "Tim": { icon: "fa-heart", class: "icon-heart" },
        "Mặc cỡ": { icon: "fa-laugh-squint", class: "icon-laugh" },
        "Xe vivu": { icon: "fa-car", class: "icon-car" },
        "Đồng hồ": { icon: "fa-clock", class: "icon-clock" },
        "máy ảnh": { icon: "fa-camera", class: "icon-camera" },
        "Mặt cười": { icon: "fa-smile-beam", class: "icon-smile" },
        "Ăn uống": { icon: "fa-utensils", class: "icon-food" },
        "Locket": { icon: "fa-mobile-alt", class: "icon-locket" },
        "18+": { icon: "fa-heart-circle", class: "icon-18plus" },
        "Bệnh viện": { icon: "fa-hospital", class: "icon-hospital" },
        "khóc": { icon: "fa-sad-tear", class: "icon-cry" },
        "hài hước": { icon: "fa-laugh-wink", class: "icon-funny" },
        "ngủ": { icon: "fa-bed", class: "icon-sleep" },
        "quà tặng": { icon: "fa-gift", class: "icon-gift" },
        "cười": { icon: "fa-grin-beam", class: "icon-smile" },
        "cảnh sát": { icon: "fa-user-shield", class: "icon-police" },
        "Hoàng hôn": { icon: "fa-sun", class: "icon-sunset" },
        "Sinh nhật": { icon: "fa-birthday-cake", class: "icon-birthday" },
        "Tình yêu": { icon: "fa-heart", class: "icon-love" },
        "cầu vồng": { icon: "fa-rainbow", class: "icon-rainbow" },
        "Trái tim rực rỡ": { icon: "fa-heart", class: "icon-heart" },
        "Tình yêu vĩnh cửu": { icon: "fa-infinity", class: "icon-forever-love" }
      };

      // Create all slides
      function createSlides() {
        slidesData.forEach((slide, index) => {
          let slideElement;

          if (index === 0) {
            // First slide is intro
            slideElement = document.createElement('div');
            slideElement.className = 'slide intro-slide';
            
            // Thêm background trái tim cho trang đầu
            const introBackground = document.createElement('div');
            introBackground.className = 'intro-background';
            
            // Tạo 20 trái tim nền
            for (let i = 0; i < 20; i++) {
              const heart = document.createElement('div');
              heart.className = 'heart-bg';
              heart.innerHTML = '<i class="fas fa-heart"></i>';
              
              // Random vị trí bắt đầu
              const startX = Math.random() * 100;
              const startY = Math.random() * 100;
              
              // Random khoảng cách di chuyển
              const moveX = (Math.random() * 200) - 100; // -100 đến 100
              const moveY = (Math.random() * 200) - 100; // -100 đến 100
              const rotate = Math.random() * 360;
              
              // Random thời gian và độ trễ
              const duration = 10 + Math.random() * 20;
              const delay = Math.random() * 10;
              
              heart.style.left = `${startX}%`;
              heart.style.top = `${startY}%`;
              heart.style.setProperty('--move-x', `${moveX}px`);
              heart.style.setProperty('--move-y', `${moveY}px`);
              heart.style.setProperty('--rotate', `${rotate}deg`);
              heart.style.animationDuration = `${duration}s`;
              heart.style.animationDelay = `${delay}s`;
              
              introBackground.appendChild(heart);
            }
            
            // Tạo các phần tử con
            const title = document.createElement('h1');
            title.textContent = 'Kỷ niệm của chúng mình';
            
            const content = document.createElement('p');
            content.textContent = slide.noi_dung;
            
            const btnNext = document.createElement('button');
            btnNext.className = 'btn-next';
            btnNext.innerHTML = 'Bắt đầu <i class="fas fa-arrow-right"></i>';
            
            // Thêm các phần tử vào slide
            slideElement.appendChild(introBackground);
            slideElement.appendChild(title);
            slideElement.appendChild(content);
            slideElement.appendChild(btnNext);
          } else if (index === slidesData.length - 1) {
            // Last slide is ending
            slideElement = document.createElement('div');
            slideElement.className = 'slide ending-slide';
            
            // Tạo background đặc biệt cho trang ending
            const endingBackground = document.createElement('div');
            endingBackground.className = 'ending-background';
            
            // Tạo hiệu ứng tim và infinity
            for (let i = 0; i < 15; i++) {
              // Thêm trái tim
              const heart = document.createElement('div');
              heart.className = 'ending-icon';
              heart.innerHTML = '<i class="fas fa-heart"></i>';
              
              // Random vị trí và thời gian
              const posX = Math.random() * 100;
              const posY = Math.random() * 100;
              const scale = 0.5 + Math.random() * 1.5;
              const delay = Math.random() * 5;
              
              heart.style.left = `${posX}%`;
              heart.style.top = `${posY}%`;
              heart.style.transform = `scale(${scale})`;
              heart.style.animationDelay = `${delay}s`;
              
              endingBackground.appendChild(heart);
              
              // Thêm biểu tượng vô cực
              if (i % 3 === 0) {
                const infinity = document.createElement('div');
                infinity.className = 'ending-icon infinity-icon';
                infinity.innerHTML = '<i class="fas fa-infinity"></i>';
                
                const infX = Math.random() * 100;
                const infY = Math.random() * 100;
                const infScale = 0.5 + Math.random() * 1;
                const infDelay = Math.random() * 5;
                
                infinity.style.left = `${infX}%`;
                infinity.style.top = `${infY}%`;
                infinity.style.transform = `scale(${infScale})`;
                infinity.style.animationDelay = `${infDelay}s`;
                
                endingBackground.appendChild(infinity);
              }
            }
            
            // Tạo các phần tử con
            const title = document.createElement('h1');
            title.textContent = 'Tình yêu của chúng mình';
            title.className = 'ending-title';
            
            const content = document.createElement('p');
            content.textContent = slide.noi_dung;
            content.className = 'ending-content';
            
            // Thêm hình trái tim lớn ở giữa
            const centerHeart = document.createElement('div');
            centerHeart.className = 'center-heart';
            centerHeart.innerHTML = '<i class="fas fa-heart"></i>';
            
            // Thêm nút quay lại
            const btnRestart = document.createElement('button');
            btnRestart.className = 'btn-next btn-restart';
            btnRestart.innerHTML = 'Xem lại <i class="fas fa-redo"></i>';
            
            // Thêm các phần tử vào slide
            slideElement.appendChild(endingBackground);
            slideElement.appendChild(title);
            slideElement.appendChild(centerHeart);
            slideElement.appendChild(content);
            slideElement.appendChild(btnRestart);
          } else {
            // Regular slides with images
            slideElement = document.createElement('div');
            slideElement.className = 'slide';

            // Check if there's a date in the content
            const dateMatch = slide.noi_dung.match(/\((\d{2}\/\d{2}\/\d{4})\)/);
            const hasDate = dateMatch !== null;
            const content = hasDate ? slide.noi_dung.replace(/\(\d{2}\/\d{2}\/\d{4}\)\s*/, '') : slide.noi_dung;
            
            let slideHTML = '';
            
            // Add date if available
            if (hasDate) {
              slideHTML += `<div class="date">${dateMatch[1]}</div>`;
            }

            // Function to get correct image extension
            function getImageExtension(imageNumber) {
              // Xử lý các trường hợp đặc biệt
              if (imageNumber === 'h18') return 'HEIC';
              if (imageNumber === 'h22') return 'PNG';
              if (imageNumber === 'h25') return 'JPG';
              return 'jpg';
            }

            // Add image with correct extension
            if (slide.ten_hinh) {
              const imgExtension = getImageExtension(slide.ten_hinh);
              slideHTML += `
                <div class="image-container">
                  <img src="img/${slide.ten_hinh}.${imgExtension}" alt="${content}" />
                </div>
              `;
            }
            
            slideHTML += `
              <div class="content">
                <p>${content}</p>
              </div>
              <button class="btn-next">Tiếp theo <i class="fas fa-arrow-right"></i></button>
            `;

            // Add animation icon if available
            if (slide.hieu_ung && animationMap[slide.hieu_ung]) {
              const animation = animationMap[slide.hieu_ung];
              slideHTML += `<div class="icon-animation ${animation.class}"><i class="fas ${animation.icon}"></i></div>`;
              
              // Add floating icons container
              slideHTML += `<div class="floating-icons" id="floatingIcons-${index}"></div>`;
            }

            slideElement.innerHTML = slideHTML;
          }

          container.appendChild(slideElement);
        });

        // Activate the first slide
        document.querySelector('.slide').classList.add('active');
        updateProgressBar();
        
        // Initialize floating icons for the first active slide
        if (currentIndex > 0 && slidesData[currentIndex].hieu_ung) {
          createFloatingIcons(currentIndex);
        }
      }

      // Create floating icons for the current slide
      function createFloatingIcons(slideIndex) {
        const currentSlide = slidesData[slideIndex];
        if (!currentSlide || !currentSlide.hieu_ung || !animationMap[currentSlide.hieu_ung]) {
          return;
        }
        
        const animation = animationMap[currentSlide.hieu_ung];
        const floatingContainer = document.getElementById(`floatingIcons-${slideIndex}`);
        
        if (!floatingContainer) return;
        
        // Clear previous icons
        floatingContainer.innerHTML = '';
        
        // Create 10 floating icons
        for (let i = 0; i < 10; i++) {
          const icon = document.createElement('div');
          icon.className = 'floating-icon';
          icon.innerHTML = `<i class="fas ${animation.icon}"></i>`;
          
          // Randomize position and animation delay
          const delay = Math.random() * 8; // Random delay between 0-8s
          const topPos = Math.random() * 100; // Random vertical position
          
          icon.style.animationDelay = `${delay}s`;
          icon.style.top = `${topPos}%`;
          
          floatingContainer.appendChild(icon);
        }
      }

      // Add event listeners for slide navigation
      function setupEventListeners() {
        container.addEventListener('click', function(e) {
          if (e.target.classList.contains('btn-next') || e.target.parentElement.classList.contains('btn-next')) {
            // Kiểm tra nếu là nút restart
            if (e.target.classList.contains('btn-restart') || e.target.parentElement.classList.contains('btn-restart')) {
              // Reset về slide đầu tiên
              const slides = document.querySelectorAll('.slide');
              slides[currentIndex].classList.remove('active');
              currentIndex = 0;
              slides[currentIndex].classList.add('active');
              updateProgressBar();
            } else {
              nextSlide();
            }
          }
        });

        // Setup music control
        btnMusic.addEventListener('click', function() {
          if (bgMusic.paused) {
            bgMusic.play();
            btnMusic.innerHTML = '<i class="fas fa-pause"></i>';
          } else {
            bgMusic.pause();
            btnMusic.innerHTML = '<i class="fas fa-play"></i>';
          }
        });

        // Try to autoplay music
        bgMusic.play().then(_ => {
          // Autoplay started!
          btnMusic.innerHTML = '<i class="fas fa-pause"></i>';
        }).catch(error => {
          // Autoplay prevented
          console.log('Autoplay prevented, waiting for user interaction');
          btnMusic.classList.add('visible');
          setupAudio();
        });
      }

      function nextSlide() {
        const slides = document.querySelectorAll('.slide');
        
        if (currentIndex < slides.length - 1) {
          slides[currentIndex].classList.remove('active');
          currentIndex++;
          slides[currentIndex].classList.add('active');
          updateProgressBar();
          
          // Create floating icons for the new slide
          if (currentIndex > 0 && slidesData[currentIndex].hieu_ung) {
            createFloatingIcons(currentIndex);
          }
          
          // Thêm hiệu ứng đặc biệt cho slide cuối cùng
          if (currentIndex === slides.length - 1) {
            setupEndingSlide();
          }
        } else {
          // Loop back to first slide
          slides[currentIndex].classList.remove('active');
          currentIndex = 0;
          slides[currentIndex].classList.add('active');
          updateProgressBar();
          
          // Create floating icons for the first slide
          if (slidesData[currentIndex].hieu_ung) {
            createFloatingIcons(currentIndex);
          }
        }
      }
      
      // Thiết lập hiệu ứng đặc biệt cho slide cuối
      function setupEndingSlide() {
        const endingIcons = document.querySelectorAll('.ending-icon');
        
        // Thiết lập hướng di chuyển ngẫu nhiên cho mỗi icon
        endingIcons.forEach(icon => {
          const moveX = (Math.random() * 100) - 50; // -50 đến 50px
          const moveY = (Math.random() * 100) - 50; // -50 đến 50px
          
          icon.style.setProperty('--float-x', `${moveX}px`);
          icon.style.setProperty('--float-y', `${moveY}px`);
        });
      }

      function updateProgressBar() {
        const progressPercentage = (currentIndex / (totalSlides - 1)) * 100;
        progressBar.style.width = `${progressPercentage}%`;
      }

      // Initialize the slideshow
      createSlides();
      setupEventListeners();

      // Add keyboard navigation
      document.addEventListener('keydown', function(e) {
        if (e.key === 'ArrowRight' || e.key === ' ') {
          nextSlide();
        }
      });
    });
  </script>
</body>
</html>
